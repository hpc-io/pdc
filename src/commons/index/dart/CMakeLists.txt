#------------------------------------------------------------------------------
# Include source and build directories
#------------------------------------------------------------------------------
include_directories(
  ${CMAKE_CURRENT_SOURCE_DIR}
)

#------------------------------------------------------------------------------
# Options
#------------------------------------------------------------------------------
#add_definitions(-DENABLE_MPI=1)
#add_definitions(-DENABLE_TIMING=1)
#add_definitions(-DENABLE_CHECKPOINT=1)
#add_definitions(-DENABLE_MULTITHREAD=1)

#------------------------------------------------------------------------------
# Configure module header files
#------------------------------------------------------------------------------
# Set unique vars used in the autogenerated config file (symbol import/export)
if(BUILD_SHARED_LIBS)
  set(PDC_BUILD_SHARED_LIBS 1)
  set(PDC_LIBTYPE SHARED)
else()
  set(PDC_BUILD_SHARED_LIBS 0)
  set(PDC_LIBTYPE STATIC)
endif()

#------------------------------------------------------------------------------
# Set sources
#------------------------------------------------------------------------------
set(DART_SRCS
  ${CMAKE_CURRENT_SOURCE_DIR}/dart_algo.c
  ${CMAKE_CURRENT_SOURCE_DIR}/dart_utils.c
  ${CMAKE_CURRENT_SOURCE_DIR}/dart_math.c
  ${CMAKE_CURRENT_SOURCE_DIR}/dart_core.c
  )

#------------------------------------------------------------------------------
# Libraries
#------------------------------------------------------------------------------
# DART
add_library(dart ${DART_SRCS})
pdc_set_lib_options(dart "dart" ${PDC_LIBTYPE})

set(PDC_EXPORTED_LIBS dart ${PDC_EXPORTED_LIBS})

#-----------------------------------------------------------------------------
# Specify project header files to be installed
#-----------------------------------------------------------------------------
set(DART_HEADERS
  ${CMAKE_CURRENT_SOURCE_DIR}/dart_algo.h
  ${CMAKE_CURRENT_SOURCE_DIR}/dart_utils.h
  ${CMAKE_CURRENT_SOURCE_DIR}/dart_math.h
  ${CMAKE_CURRENT_SOURCE_DIR}/dart_core.h
  )

#-----------------------------------------------------------------------------
# Add file(s) to CMake Install
#-----------------------------------------------------------------------------
install(
  FILES
    ${DART_HEADERS}
  DESTINATION
    ${PDC_INSTALL_INCLUDE_DIR}
  COMPONENT
    headers
)

#-----------------------------------------------------------------------------
# Add Target(s) to CMake Install
#-----------------------------------------------------------------------------
install(
  TARGETS
    dart
  EXPORT
    ${PDC_EXPORTED_TARGETS}
  LIBRARY DESTINATION ${PDC_INSTALL_LIB_DIR}
  ARCHIVE DESTINATION ${PDC_INSTALL_LIB_DIR}
  RUNTIME DESTINATION ${PDC_INSTALL_BIN_DIR}
)

#------------------------------------------------------------------------------
# Set variables for parent scope
#------------------------------------------------------------------------------
# Used by config.cmake.build.in and Testing
set(PDC_INCLUDES_BUILD_TIME
  ${CMAKE_CURRENT_SOURCE_DIR}
  ${CMAKE_CURRENT_BINARY_DIR}
  ${PDC_EXT_INCLUDE_DEPENDENCIES}
  PARENT_SCOPE
)

# Used by config.cmake.install.in
set(PDC_INCLUDES_INSTALL_TIME
  ${PDC_INSTALL_INCLUDE_DIR}
  ${PDC_EXT_INCLUDE_DEPENDENCIES}
  PARENT_SCOPE
)